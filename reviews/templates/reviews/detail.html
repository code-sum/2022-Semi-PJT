{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% bootstrap_css %}
{% block css %}{% endblock %}
{% block content %}

<div class="container mt-3 border border-opacity-10 border-2 rounded-3">
    <div class="row">
        <div class="col-6 d-flex justify-content-center">
            <div class="card text-center" style="width: 20rem;">
                <img  src="{{ review.image.url }}" alt="{{ review.image }}" class="card-img-top">
                <div class="card-body">
                    <h5 class="card-title">식당이름:
                        {{ review.restaurant.name }}</h5>
                    <h6 class="mt-1 card-subtitle mb-2 text-muted">유저이름:
                        {{ review.user }}</h6>
                    <p class="card-text">리뷰내용:
                        {{ review.content }}.</p>
                    <i class="cart-footer">평점:
                        {{ review.get_grade_display }}</i>
                    {% if request.user.is_authenticated %}
                    <a href="{% url 'reviews:update' review.pk %}" class="btn btn-btn-outline-info">수정</a><a href="{% url 'reviews:delete' review.pk %}" class="btn btn-btn-outline-info">삭제</a>
                    
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-6">
            <h4 class="my-3">댓글</h4>
            {% if comments %}
            <span>{{ comments|length }}개의 댓글이 있습니다.</span>
            {% endif %}
        {% if request.user.is_authenticated %}

            <form action="{% url 'reviews:comment_create' review.pk %}" method="POST">
            {% csrf_token %}
            {% bootstrap_form comment_form layout='inline'%}
            {% bootstrap_button button_type="submit" content="작성" button_class="btn-outline-info btn-sm" %}
            </form>
            <hr>
            {% for comment in comments %}
            <p style="font-size:7px;">
                {{ comment.user.username }}
            </p>
            <p>{{ comment.content }}
                <a href="{% url 'reviews:comment_delete' comment.review.pk comment.pk %}" class="btn btn-outline-info btn-sm">삭제</a>
            </p>

            <hr>
            {% empty %}
            <p>댓글이 없어요 ㅠ_ㅠ</p>
            {% endfor %}
        {% else %}
        {% endif %}
        </div>
    </div>
</div>
{% endblock content %}
{% bootstrap_javascript %}